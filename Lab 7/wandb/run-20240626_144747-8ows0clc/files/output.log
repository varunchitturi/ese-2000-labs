/var/folders/7w/qhjx915d72v4nkt0gpls0m_h0000gn/T/ipykernel_23879/2303900051.py:6: UserWarning: cumprod_out_mps supported by MPS on MacOS 13+, please upgrade (Triggered internally at /Users/runner/work/_temp/anaconda/conda-bld/pytorch_1702400154748/work/aten/src/ATen/native/mps/operations/UnaryOps.mm:406.)
  alpha_hat_t_list = torch.cumprod(alpha_t_list, dim=0).to(device)
/Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages/torch/nn/functional.py:3983: UserWarning: MPS: passing scale factor to upsample ops is supported natively starting from macOS 13.0. Falling back on CPU. This may have performance implications. (Triggered internally at /Users/runner/work/_temp/anaconda/conda-bld/pytorch_1702400154748/work/aten/src/ATen/native/mps/operations/UpSample.mm:246.)
  return torch._C._nn.upsample_nearest2d(input, output_size, scale_factors)
Epoch 1 / 500 finished
Epoch 2 / 500 finished
Epoch 3 / 500 finished
Epoch 4 / 500 finished
Epoch 5 / 500 finished
Epoch 6 / 500 finished
Epoch 7 / 500 finished
Epoch 8 / 500 finished
Epoch 9 / 500 finished
Epoch 10 / 500 finished
Epoch 11 / 500 finished
Epoch 12 / 500 finished
Epoch 13 / 500 finished
Epoch 14 / 500 finished
Epoch 15 / 500 finished
Epoch 16 / 500 finished
Epoch 17 / 500 finished
Epoch 18 / 500 finished
Epoch 19 / 500 finished
Epoch 20 / 500 finished
Epoch 21 / 500 finished
Epoch 22 / 500 finished
Epoch 23 / 500 finished
Epoch 24 / 500 finished
Epoch 25 / 500 finished
Epoch 26 / 500 finished
Epoch 27 / 500 finished
Epoch 28 / 500 finished
Epoch 29 / 500 finished
Epoch 30 / 500 finished
Epoch 31 / 500 finished
Epoch 32 / 500 finished
Epoch 33 / 500 finished
Epoch 34 / 500 finished
Epoch 35 / 500 finished
Epoch 36 / 500 finished
Epoch 37 / 500 finished
Epoch 38 / 500 finished
Epoch 39 / 500 finished
Epoch 40 / 500 finished
Epoch 41 / 500 finished
Epoch 42 / 500 finished
Epoch 43 / 500 finished
Epoch 44 / 500 finished
Epoch 45 / 500 finished
Epoch 46 / 500 finished
Epoch 47 / 500 finished
Epoch 48 / 500 finished
Epoch 49 / 500 finished
Epoch 50 / 500 finished
Epoch 51 / 500 finished
Epoch 52 / 500 finished
Epoch 53 / 500 finished
Epoch 54 / 500 finished
Epoch 55 / 500 finished
Epoch 56 / 500 finished
Epoch 57 / 500 finished
Epoch 58 / 500 finished
Epoch 59 / 500 finished
Epoch 60 / 500 finished
Epoch 61 / 500 finished
Epoch 62 / 500 finished
Epoch 63 / 500 finished
Epoch 64 / 500 finished
Epoch 65 / 500 finished
Epoch 66 / 500 finished
Epoch 67 / 500 finished
Epoch 68 / 500 finished
Epoch 69 / 500 finished
Epoch 70 / 500 finished
Epoch 71 / 500 finished
Epoch 72 / 500 finished
Epoch 73 / 500 finished
Epoch 74 / 500 finished
Epoch 75 / 500 finished
Epoch 76 / 500 finished
Epoch 77 / 500 finished
Epoch 78 / 500 finished
Epoch 79 / 500 finished
Epoch 80 / 500 finished
Epoch 81 / 500 finished
Epoch 82 / 500 finished
Epoch 83 / 500 finished
Epoch 84 / 500 finished
Epoch 85 / 500 finished
Epoch 86 / 500 finished
Epoch 87 / 500 finished
Epoch 88 / 500 finished
Epoch 89 / 500 finished
Epoch 90 / 500 finished
Epoch 91 / 500 finished
Epoch 92 / 500 finished
Epoch 93 / 500 finished
Epoch 94 / 500 finished
Epoch 95 / 500 finished
Epoch 96 / 500 finished
Epoch 97 / 500 finished
Epoch 98 / 500 finished
Epoch 99 / 500 finished
Epoch 100 / 500 finished
Epoch 101 / 500 finished
Epoch 102 / 500 finished
Epoch 103 / 500 finished
Epoch 104 / 500 finished
Epoch 105 / 500 finished
Epoch 106 / 500 finished
Epoch 107 / 500 finished
Epoch 108 / 500 finished
Epoch 109 / 500 finished
Epoch 110 / 500 finished
Epoch 111 / 500 finished
Epoch 112 / 500 finished
Epoch 113 / 500 finished
Epoch 114 / 500 finished
Epoch 115 / 500 finished
Epoch 116 / 500 finished
Epoch 117 / 500 finished
Epoch 118 / 500 finished
Epoch 119 / 500 finished
Epoch 120 / 500 finished
Epoch 121 / 500 finished
Epoch 122 / 500 finished
Epoch 123 / 500 finished
Epoch 124 / 500 finished
Epoch 125 / 500 finished
Epoch 126 / 500 finished
Epoch 127 / 500 finished
Epoch 128 / 500 finished
Epoch 129 / 500 finished
Epoch 130 / 500 finished
Epoch 131 / 500 finished
Epoch 132 / 500 finished
Epoch 133 / 500 finished
Epoch 134 / 500 finished
Epoch 135 / 500 finished
Epoch 136 / 500 finished
Epoch 137 / 500 finished
Epoch 138 / 500 finished
Epoch 139 / 500 finished
Epoch 140 / 500 finished
Epoch 141 / 500 finished
Epoch 142 / 500 finished
Epoch 143 / 500 finished
Epoch 144 / 500 finished
Epoch 145 / 500 finished
Epoch 146 / 500 finished
Epoch 147 / 500 finished
Epoch 148 / 500 finished
Epoch 149 / 500 finished
Epoch 150 / 500 finished
Epoch 151 / 500 finished
Epoch 152 / 500 finished
Epoch 153 / 500 finished
Epoch 154 / 500 finished
Epoch 155 / 500 finished
Epoch 156 / 500 finished
Epoch 157 / 500 finished
Epoch 158 / 500 finished
Epoch 159 / 500 finished
Epoch 160 / 500 finished
Epoch 161 / 500 finished
Epoch 162 / 500 finished
Epoch 163 / 500 finished
Epoch 164 / 500 finished
Epoch 165 / 500 finished
Epoch 166 / 500 finished
Epoch 167 / 500 finished
Epoch 168 / 500 finished
Epoch 169 / 500 finished
Epoch 170 / 500 finished
Epoch 171 / 500 finished
Epoch 172 / 500 finished
Epoch 173 / 500 finished
Epoch 174 / 500 finished
Epoch 175 / 500 finished
Epoch 176 / 500 finished
Epoch 177 / 500 finished
Epoch 178 / 500 finished
Epoch 179 / 500 finished
Epoch 180 / 500 finished
Epoch 181 / 500 finished
Epoch 182 / 500 finished
Epoch 183 / 500 finished
Epoch 184 / 500 finished
Epoch 185 / 500 finished
Epoch 186 / 500 finished
Epoch 187 / 500 finished
Epoch 188 / 500 finished
Epoch 189 / 500 finished
Epoch 190 / 500 finished
Epoch 191 / 500 finished
Epoch 192 / 500 finished
Epoch 193 / 500 finished
Epoch 194 / 500 finished
Epoch 195 / 500 finished
Epoch 196 / 500 finished
Epoch 197 / 500 finished
Epoch 198 / 500 finished
Epoch 199 / 500 finished
Epoch 200 / 500 finished
Epoch 201 / 500 finished
Epoch 202 / 500 finished
Epoch 203 / 500 finished
Epoch 204 / 500 finished
Epoch 205 / 500 finished
Epoch 206 / 500 finished
Epoch 207 / 500 finished
Epoch 208 / 500 finished
Epoch 209 / 500 finished
Epoch 210 / 500 finished
Epoch 211 / 500 finished
Epoch 212 / 500 finished
Epoch 213 / 500 finished
Epoch 214 / 500 finished
Epoch 215 / 500 finished
Epoch 216 / 500 finished
Epoch 217 / 500 finished
Epoch 218 / 500 finished
Epoch 219 / 500 finished
Epoch 220 / 500 finished
Epoch 221 / 500 finished
Epoch 222 / 500 finished
Epoch 223 / 500 finished
Epoch 224 / 500 finished
Epoch 225 / 500 finished
Epoch 226 / 500 finished
Epoch 227 / 500 finished
Epoch 228 / 500 finished
Epoch 229 / 500 finished
Epoch 230 / 500 finished
Epoch 231 / 500 finished
Epoch 232 / 500 finished
Epoch 233 / 500 finished
Epoch 234 / 500 finished
Epoch 235 / 500 finished
Epoch 236 / 500 finished
Epoch 237 / 500 finished
Epoch 238 / 500 finished
Epoch 239 / 500 finished
Epoch 240 / 500 finished
Epoch 241 / 500 finished
Epoch 242 / 500 finished
Epoch 243 / 500 finished
Epoch 244 / 500 finished
Epoch 245 / 500 finished
Epoch 246 / 500 finished
Epoch 247 / 500 finished
Epoch 248 / 500 finished
Epoch 249 / 500 finished
Epoch 250 / 500 finished
Epoch 251 / 500 finished
Epoch 252 / 500 finished
Epoch 253 / 500 finished
Epoch 254 / 500 finished
Epoch 255 / 500 finished
Epoch 256 / 500 finished
Epoch 257 / 500 finished
Epoch 258 / 500 finished
Epoch 259 / 500 finished
Epoch 260 / 500 finished
Epoch 261 / 500 finished
Epoch 262 / 500 finished
Epoch 263 / 500 finished
Epoch 264 / 500 finished
Epoch 265 / 500 finished
Epoch 266 / 500 finished
Epoch 267 / 500 finished
Epoch 268 / 500 finished
Epoch 269 / 500 finished
Epoch 270 / 500 finished
Epoch 271 / 500 finished
Epoch 272 / 500 finished
Epoch 273 / 500 finished
Epoch 274 / 500 finished
Epoch 275 / 500 finished
Epoch 276 / 500 finished
Epoch 277 / 500 finished
Epoch 278 / 500 finished
Epoch 279 / 500 finished
Epoch 280 / 500 finished
Epoch 281 / 500 finished
Epoch 282 / 500 finished
Epoch 283 / 500 finished
Epoch 284 / 500 finished
Epoch 285 / 500 finished
Epoch 286 / 500 finished
Epoch 287 / 500 finished
Epoch 288 / 500 finished
Epoch 289 / 500 finished
Epoch 290 / 500 finished
Epoch 291 / 500 finished
Epoch 292 / 500 finished
Epoch 293 / 500 finished
Epoch 294 / 500 finished
Epoch 295 / 500 finished
Epoch 296 / 500 finished
Epoch 297 / 500 finished
Epoch 298 / 500 finished
Epoch 299 / 500 finished
Epoch 300 / 500 finished
Epoch 301 / 500 finished
Epoch 302 / 500 finished
Epoch 303 / 500 finished
Epoch 304 / 500 finished
Epoch 305 / 500 finished
Epoch 306 / 500 finished
Epoch 307 / 500 finished
Epoch 308 / 500 finished
Epoch 309 / 500 finished
Epoch 310 / 500 finished
Epoch 311 / 500 finished
Epoch 312 / 500 finished
Epoch 313 / 500 finished
Epoch 314 / 500 finished
Epoch 315 / 500 finished
Epoch 316 / 500 finished
Epoch 317 / 500 finished
Epoch 318 / 500 finished
Epoch 319 / 500 finished
Epoch 320 / 500 finished
Epoch 321 / 500 finished
Epoch 322 / 500 finished
Epoch 323 / 500 finished
Epoch 324 / 500 finished
Epoch 325 / 500 finished
Epoch 326 / 500 finished
Epoch 327 / 500 finished
Epoch 328 / 500 finished
Epoch 329 / 500 finished
Epoch 330 / 500 finished
Epoch 331 / 500 finished
Epoch 332 / 500 finished
Epoch 333 / 500 finished
Epoch 334 / 500 finished
Epoch 335 / 500 finished
Epoch 336 / 500 finished
Epoch 337 / 500 finished
Epoch 338 / 500 finished
Epoch 339 / 500 finished
Epoch 340 / 500 finished
Epoch 341 / 500 finished
Epoch 342 / 500 finished
Epoch 343 / 500 finished
Epoch 344 / 500 finished
Epoch 345 / 500 finished
Epoch 346 / 500 finished
Epoch 347 / 500 finished
Epoch 348 / 500 finished
Epoch 349 / 500 finished
Epoch 350 / 500 finished
Epoch 351 / 500 finished
Epoch 352 / 500 finished
Epoch 353 / 500 finished
Epoch 354 / 500 finished
Epoch 355 / 500 finished
Epoch 356 / 500 finished
Epoch 357 / 500 finished
Epoch 358 / 500 finished
Epoch 359 / 500 finished
Epoch 360 / 500 finished
Epoch 361 / 500 finished
Epoch 362 / 500 finished
Epoch 363 / 500 finished
Epoch 364 / 500 finished
Epoch 365 / 500 finished
Epoch 366 / 500 finished
Epoch 367 / 500 finished
Epoch 368 / 500 finished
Epoch 369 / 500 finished
Epoch 370 / 500 finished
Epoch 371 / 500 finished
Epoch 372 / 500 finished
Epoch 373 / 500 finished
Epoch 374 / 500 finished
Epoch 375 / 500 finished
Epoch 376 / 500 finished
Epoch 377 / 500 finished
Epoch 378 / 500 finished
Epoch 379 / 500 finished
Epoch 380 / 500 finished
Epoch 381 / 500 finished
Epoch 382 / 500 finished
Epoch 383 / 500 finished
Epoch 384 / 500 finished
Epoch 385 / 500 finished
Epoch 386 / 500 finished
Epoch 387 / 500 finished
Epoch 388 / 500 finished
Epoch 389 / 500 finished
Epoch 390 / 500 finished
Epoch 391 / 500 finished
Epoch 392 / 500 finished
Epoch 393 / 500 finished
Epoch 394 / 500 finished
Epoch 395 / 500 finished
Epoch 396 / 500 finished
Epoch 397 / 500 finished
Epoch 398 / 500 finished
Epoch 399 / 500 finished
Epoch 400 / 500 finished
Epoch 401 / 500 finished
Epoch 402 / 500 finished
Epoch 403 / 500 finished
Epoch 404 / 500 finished
Epoch 405 / 500 finished
Epoch 406 / 500 finished
Epoch 407 / 500 finished
Epoch 408 / 500 finished
Epoch 409 / 500 finished
Epoch 410 / 500 finished
Epoch 411 / 500 finished
Epoch 412 / 500 finished
Epoch 413 / 500 finished
Epoch 414 / 500 finished
Epoch 415 / 500 finished
Epoch 416 / 500 finished
Epoch 417 / 500 finished
Epoch 418 / 500 finished
Epoch 419 / 500 finished
Epoch 420 / 500 finished
Epoch 421 / 500 finished
Epoch 422 / 500 finished
Epoch 423 / 500 finished
Epoch 424 / 500 finished
Epoch 425 / 500 finished
Epoch 426 / 500 finished
Epoch 427 / 500 finished
Epoch 428 / 500 finished
Epoch 429 / 500 finished
Epoch 430 / 500 finished
Epoch 431 / 500 finished
Epoch 432 / 500 finished
Epoch 433 / 500 finished
Epoch 434 / 500 finished
Epoch 435 / 500 finished
Epoch 436 / 500 finished
Epoch 437 / 500 finished
Epoch 438 / 500 finished
Epoch 439 / 500 finished
Epoch 440 / 500 finished
Epoch 441 / 500 finished
Epoch 442 / 500 finished
Epoch 443 / 500 finished
Epoch 444 / 500 finished
Epoch 445 / 500 finished
Epoch 446 / 500 finished
Epoch 447 / 500 finished
Epoch 448 / 500 finished
Epoch 449 / 500 finished
Epoch 450 / 500 finished
Epoch 451 / 500 finished
Epoch 452 / 500 finished
Epoch 453 / 500 finished
Epoch 454 / 500 finished
Epoch 455 / 500 finished
Epoch 456 / 500 finished
Epoch 457 / 500 finished
Epoch 458 / 500 finished
Epoch 459 / 500 finished
Epoch 460 / 500 finished
Epoch 461 / 500 finished
Epoch 462 / 500 finished
Epoch 463 / 500 finished
Epoch 464 / 500 finished
Epoch 465 / 500 finished
Epoch 466 / 500 finished
Epoch 467 / 500 finished
Epoch 468 / 500 finished
Epoch 469 / 500 finished
Epoch 470 / 500 finished
Epoch 471 / 500 finished
Epoch 472 / 500 finished
Epoch 473 / 500 finished
Epoch 474 / 500 finished
Epoch 475 / 500 finished
Epoch 476 / 500 finished
Epoch 477 / 500 finished
Epoch 478 / 500 finished
Epoch 479 / 500 finished
Epoch 480 / 500 finished
Epoch 481 / 500 finished
Epoch 482 / 500 finished
Epoch 483 / 500 finished
Epoch 484 / 500 finished
Epoch 485 / 500 finished
Epoch 486 / 500 finished
Epoch 487 / 500 finished
Epoch 488 / 500 finished
Epoch 489 / 500 finished
Epoch 490 / 500 finished
Epoch 491 / 500 finished
Epoch 492 / 500 finished
Epoch 493 / 500 finished
Epoch 494 / 500 finished
Epoch 495 / 500 finished
Epoch 496 / 500 finished
Epoch 497 / 500 finished
Epoch 498 / 500 finished
Epoch 499 / 500 finished
Epoch 500 / 500 finished
Model added to WandB - ArtifactManifestEntry(path='model.pth', digest='vPhdrrsfj4TrAYTF3qE90g==', size=268647346, local_path='/Users/teresa/Library/Application Support/wandb/artifacts/staging/tmpggrozlmp', skip_cache=False)
Iteration 0, Loss 0.04131224751472473
Iteration 1, Loss 0.03156961500644684
Iteration 2, Loss 0.03290780261158943
Iteration 3, Loss 0.03906947001814842
Average test loss: 0.036214783787727356
Collecting accelerate
  Downloading accelerate-0.31.0-py3-none-any.whl.metadata (19 kB)
Requirement already satisfied: numpy>=1.17 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (1.24.3)
Requirement already satisfied: packaging>=20.0 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (23.1)
Requirement already satisfied: psutil in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (5.9.0)
Requirement already satisfied: pyyaml in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (6.0.1)
Requirement already satisfied: torch>=1.10.0 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (2.1.2)
Requirement already satisfied: huggingface-hub in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (0.22.2)
Requirement already satisfied: safetensors>=0.3.1 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from accelerate) (0.4.2)
Requirement already satisfied: filelock in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (3.13.1)
Requirement already satisfied: typing-extensions in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (4.5.0)
Requirement already satisfied: sympy in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (1.12)
Requirement already satisfied: networkx in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (3.1)
Requirement already satisfied: jinja2 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (3.1.2)
Requirement already satisfied: fsspec in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from torch>=1.10.0->accelerate) (2024.3.1)
Requirement already satisfied: requests in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from huggingface-hub->accelerate) (2.31.0)
Requirement already satisfied: tqdm>=4.42.1 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from huggingface-hub->accelerate) (4.65.0)
Requirement already satisfied: MarkupSafe>=2.0 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.3)
Requirement already satisfied: charset-normalizer<4,>=2 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from requests->huggingface-hub->accelerate) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from requests->huggingface-hub->accelerate) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from requests->huggingface-hub->accelerate) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from requests->huggingface-hub->accelerate) (2024.2.2)
Requirement already satisfied: mpmath>=0.19 in /Users/teresa/miniconda3/envs/ese2000/lib/python3.8/site-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)
Downloading accelerate-0.31.0-py3-none-any.whl (309 kB)
   [90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [32m309.4/309.4 kB[39m [31m6.2 MB/s[39m eta [36m0:00:00
[?25hInstalling collected packages: accelerate
Successfully installed accelerate-0.31.0
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.login() after wandb.init() has no effect.